<form class="container" id="formAluno" method="post">
    <div class="card-info">
        Lorem ipsum dolor sit, amet consectetur adipisicing elit. Sit maxime necessitatibus alias error voluptatem
        suscipit recusandae voluptatum harum consectetur. Ad accusamus magnam animi, asperiores explicabo exercitationem
        at laudantium consequuntur dicta!]
    </div>

    <div class="form-group">
        <div id="mensagensAviso"></div>

        <div class="form-group">
            <label>Nome</label>
            <input type="text" name="nome" id="nome" placeholder="Nome do aluno" value="">
        </div>
        <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" id="email" placeholder="Email" value="">
        </div>
        <div class="form-group">
            <label>Ra:</label>
            <input type="text" name="ra" id="ra" placeholder="Nome do aluno" value="">
        </div>
        <div class="form-group">
            <label>Telefone</label>
            <input type="text" name="telefone" id="telefone" placeholder="Telefone" value="">
        </div>
        <div class="form-group">
            <label>Data de nascimento</label>
            <input type="date" name="dataNasc" id="dataNasc" value="">
        </div>

        <div class="form-group">
            <label for="cursos">Escolha um curso:</label>
            <select id="cursos" name="cursoNome">
                <option value="" style="display: none;" selected>Selecione curso...</option>
            </select>
        </div>

        <div class="form-group">
            <input type="submit" value="Cadastrar">
        </div>
    </div>
</form>

<script>

    const nome = document.querySelector('#nome').value;
    const email = document.querySelector('#email').value;
    const ra = document.querySelector('#ra').value;
    const telefone = document.querySelector('#telefone').value;
    const dataNasc = document.querySelector('#dataNasc').value;


    function mostrarAviso(mensagem, tipo = 'info') {
        const mensagensAviso = document.querySelector('#mensagensAviso');
        mensagensAviso.innerHTML = `<div class="aviso ${tipo}">${mensagem}</div>`;
    }

    function getApiCurso() {
        // Fazer solicitação GET para obter dados do servidor PHP
        fetch('http://localhost:8080/api/v1/getCurso.php', {
            method: 'GET',
            credentials: 'include'
        })
            .then(response => {
                return response.json();
            })
            .then(data => {
                console.log(data);
                const selectCurso = document.getElementById('cursos');

                data.forEach(curso => {
                    const option = document.createElement('option');
                    option.value = curso.idCurso;
                    option.textContent = curso.nomeCurso;
                    selectCurso.appendChild(option);
                });
            })
            .catch(error => {
                console.error('Erro:', error);
            });
    }
    getApiCurso();

    document.getElementById('formAluno').addEventListener('submit', function (event) {
        event.preventDefault(); // Evita o envio padrão do formulário

        // Captura os dados do formulário
        const formData = new FormData(this);

        // Faz o POST dos dados para a API de cadastro de aluno
        fetch('http://localhost:8080/api/v1/cadAluno.php', {
            method: 'POST',
            body: formData,
            credentials: 'include'
        })
            .then(response => response.json())
            .then(data => {
                console.log('Cadastro realizado:', data);
                mostrarAviso('Dados enviados com sucesso!', 'sucesso');

                this.reset();
            })
            .catch(error => {
                console.error('Erro:', error);
                alert('Erro ao cadastrar aluno. Por favor, tente novamente.');
            });
    });
</script>