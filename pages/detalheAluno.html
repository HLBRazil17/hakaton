<section id="aluno-detalhes">

    <button onclick="deleteCurriculo(1)">Deletar Currículo</button>
</section>

<script>
    // Obtendo a URL atual
    const url = window.location.href;

    // Usando o URLSearchParams para obter os parâmetros da URL
    const params = new URLSearchParams(new URL(url).search);

    // Obtendo o valor do parâmetro 'iduser'
    const alunoId = params.get('idUser');

    function getApiAluno() {
        // Fazer solicitação GET para obter dados do servidor PHP
        fetch(`http://localhost:8080/api/v1/getCurriculo.php?idUser=${alunoId}`, {
            method: 'GET',
            credentials: 'include'
        })
            .then(response => {
                return response.json();
            })
            .then(data => {
                console.log(data);
                renderAlunoDetalhes(data[0]);
            })
            .catch(error => {
                console.error('Erro:', error);
            });
    }
    getApiAluno();

    // Função para renderizar os detalhes do aluno
    function renderAlunoDetalhes(aluno) {
        const alunoDetalhes = document.getElementById('aluno-detalhes');

        const alunoDiv = document.createElement('div');
        alunoDiv.className = 'aluno';

        const alunoContent = `
            <p><strong>ID:</strong> ${aluno.iduser}</p>
            <p><strong>Nome:</strong> ${aluno.nome}</p>
            <p><strong>RA:</strong> ${aluno.ra}</p>
            <p><strong>Email:</strong> ${aluno.email}</p>
        `;

        alunoDiv.innerHTML = alunoContent;
        alunoDetalhes.appendChild(alunoDiv);
    }

    function deleteCurriculo(idCurriculo) {
        fetch(`http://localhost:8080/api/v1/deleteCurriculo.php?idCurriculo=${idCurriculo}`, {
            method: 'DELETE',
            credentials: 'include'
        })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(data.success);
                } else {
                    alert(data.error);
                }
                console.log('Resposta:', data);
            })
            .catch(error => {
                console.error('Erro ao deletar currículo:', error);
                alert('Erro ao deletar currículo. Por favor, tente novamente.');
            });
    }
</script>